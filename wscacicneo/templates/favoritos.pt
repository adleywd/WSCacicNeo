<metal:main use-macro="load: master.pt">
	<metal:content fill-slot="conteudo">
        <div class="col-md-4" style="margin-left: 200px;">
              <div class="widget">
                <div class="widget-head">
                  <div class="pull-left">Editar</div>
                  <div class="widget-icons pull-right">
                    <a href="#" class="wminimize"><i class="fa fa-chevron-up"></i></a>
                  </div>
                  <div class="clearfix"></div>
                </div>
                <div class="widget-content">
                  <div class="padd">
                    <!-- Visitors, pageview, bounce rate, etc., Sparklines plugin used -->
                    <ul  id='itens' class="current-status">
                        <li tal:repeat="i itens">
                            <a id="${i}">${i}</a>
                        </li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="widget">
                <div class="widget-head">
                  <div class="pull-left">Favoritos</div>
                  <div class="widget-icons pull-right">
                    <a href="#" class="wminimize"><i class="fa fa-chevron-up"></i></a>
                  </div>
                  <div class="clearfix"></div>
                </div>
                <div class="widget-content">
                  <div class="padd">
                    <!-- Visitors, pageview, bounce rate, etc., Sparklines plugin used -->
                    <ul id="favoritos" class="current-status">
                        <li tal:repeat="doc favoritos">
                            <a id="${doc}">${doc}</a>
                        </li>
                    </ul>
                  </div>
                </div>
              </div>
            <button type="button" class="btn btn-sm btn-default">Salvar</button>
            </div>
            <input style="display:none;" id='url' value="${request.matchdict['matricula']}">
    </metal:content>
	<metal:content fill-slot="javascript">
        <script type="text/javascript">
            $('#itens li').on('click', function(){
                index = $(this).index()
                a = $(this).find('a')
                value = $(a).html()
                itens = ${itens}
                itens.splice(index, 1)
                favoritos = ${favoritos}
                matricola = $('#url').val()
                favoritos.push(value)
                var data = {
                    'matricola': matricola,
                    'index': index,
                    'favoritos': favoritos,
                    'itens': itens,
                    'nome' : '${nome}',
                    'matricula' : '${matricula}',
                    'email' : '${email}',
                    'orgao' : '${orgao}',
                    'telefone' : '${telefone}',
                    'cargo' : '${cargo}',
                    'setor' : '${setor}', 
                    'permissao' : '$permissao',
                    'senha' : '${senha}'
                }
                json = JSON.stringify({'documento': data})
                $.ajax({
                        type: "PUT",
                        url: "${request.route_url('root')}edit_favoritos",
                        data: json, 
                        contentType: 'application/json',
                        success: function(){ location.reload(); },
                        error: function(){ alert('NÃ£o foi desta vez Tente novamente mais tarde') },
               });
            });
        </script>
    </metal:content>
</metal:main>
